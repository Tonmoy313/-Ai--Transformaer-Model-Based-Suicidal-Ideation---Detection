{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":23074,"status":"ok","timestamp":1700066785268,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"EBzPQj6SbYE3","outputId":"a0a42c92-d4c8-4b6a-ab3d-64d36bca2187"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"vEyQ2fM3G7eU","executionInfo":{"status":"ok","timestamp":1700066789693,"user_tz":-360,"elapsed":4431,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"}}},"outputs":[],"source":["import torch\n","device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")"]},{"cell_type":"markdown","metadata":{"id":"qAI1JYDOYw0p"},"source":["# **Packages**"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12744,"status":"ok","timestamp":1700066802411,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"HphTTiceUD-V","outputId":"394d56ba-226e-49cb-da18-2269f449e213"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting accelerate\n","  Downloading accelerate-0.24.1-py3-none-any.whl (261 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m261.4/261.4 kB\u001b[0m \u001b[31m4.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from accelerate) (1.23.5)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (23.2)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.10/dist-packages (from accelerate) (6.0.1)\n","Requirement already satisfied: torch>=1.10.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.1.0+cu118)\n","Collecting huggingface-hub (from accelerate)\n","  Downloading huggingface_hub-0.19.3-py3-none-any.whl (311 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m311.2/311.2 kB\u001b[0m \u001b[31m21.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (3.13.1)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (4.5.0)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (1.12)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (3.2.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (3.1.2)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (2023.6.0)\n","Requirement already satisfied: triton==2.1.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (2.1.0)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from huggingface-hub->accelerate) (2.31.0)\n","Requirement already satisfied: tqdm>=4.42.1 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub->accelerate) (4.66.1)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.10.0->accelerate) (2.1.3)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub->accelerate) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub->accelerate) (3.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub->accelerate) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub->accelerate) (2023.7.22)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.10.0->accelerate) (1.3.0)\n","Installing collected packages: huggingface-hub, accelerate\n","Successfully installed accelerate-0.24.1 huggingface-hub-0.19.3\n"]}],"source":["pip install accelerate"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9522,"status":"ok","timestamp":1700066811914,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"ZFr8-8yoT5YM","outputId":"c5f1dbcc-90ed-4bb1-f128-ee3e2ac2c9ba"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting datasets\n","  Downloading datasets-2.14.7-py3-none-any.whl (520 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m520.4/520.4 kB\u001b[0m \u001b[31m7.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.23.5)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (9.0.0)\n","Collecting pyarrow-hotfix (from datasets)\n","  Downloading pyarrow_hotfix-0.5-py3-none-any.whl (7.8 kB)\n","Collecting dill<0.3.8,>=0.3.0 (from datasets)\n","  Downloading dill-0.3.7-py3-none-any.whl (115 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m115.3/115.3 kB\u001b[0m \u001b[31m13.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.31.0)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.66.1)\n","Requirement already satisfied: xxhash in /usr/local/lib/python3.10/dist-packages (from datasets) (3.4.1)\n","Collecting multiprocess (from datasets)\n","  Downloading multiprocess-0.70.15-py310-none-any.whl (134 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.8/134.8 kB\u001b[0m \u001b[31m15.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: fsspec[http]<=2023.10.0,>=2023.1.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.6.0)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from datasets) (3.8.6)\n","Requirement already satisfied: huggingface-hub<1.0.0,>=0.14.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.19.3)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.2)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0.1)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (23.1.0)\n","Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (3.3.2)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (6.0.4)\n","Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (4.0.3)\n","Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.9.2)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.4.0)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.3.1)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.14.0->datasets) (3.13.1)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.14.0->datasets) (4.5.0)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2023.7.22)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2023.3.post1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)\n","Installing collected packages: pyarrow-hotfix, dill, multiprocess, datasets\n","Successfully installed datasets-2.14.7 dill-0.3.7 multiprocess-0.70.15 pyarrow-hotfix-0.5\n"]}],"source":["pip install datasets"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":38755,"status":"ok","timestamp":1700066850652,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"PtO5foq8Yov-","outputId":"237b7c4b-6153-499c-87e5-450bad61ca3c"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting transformers\n","  Downloading transformers-4.35.2-py3-none-any.whl (7.9 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.9/7.9 MB\u001b[0m \u001b[31m28.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.13.1)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.16.4 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.19.3)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.23.5)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.2)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0.1)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2023.6.3)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.31.0)\n","Collecting tokenizers<0.19,>=0.14 (from transformers)\n","  Downloading tokenizers-0.15.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m3.8/3.8 MB\u001b[0m \u001b[31m50.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting safetensors>=0.3.1 (from transformers)\n","  Downloading safetensors-0.4.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m56.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.66.1)\n","Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.16.4->transformers) (2023.6.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.16.4->transformers) (4.5.0)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2023.7.22)\n","Installing collected packages: safetensors, tokenizers, transformers\n","Successfully installed safetensors-0.4.0 tokenizers-0.15.0 transformers-4.35.2\n"]}],"source":["!pip install transformers"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16139,"status":"ok","timestamp":1700066866769,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"Cu8YVVq9Pce9","outputId":"97070b4e-2b1a-4a4c-a92e-7d3261faf864"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting evaluate\n","  Downloading evaluate-0.4.1-py3-none-any.whl (84 kB)\n","\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/84.1 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[91m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[90m╺\u001b[0m\u001b[90m━━━━━━━━━━\u001b[0m \u001b[32m61.4/84.1 kB\u001b[0m \u001b[31m1.7 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m84.1/84.1 kB\u001b[0m \u001b[31m1.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: datasets>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from evaluate) (2.14.7)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from evaluate) (1.23.5)\n","Requirement already satisfied: dill in /usr/local/lib/python3.10/dist-packages (from evaluate) (0.3.7)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from evaluate) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from evaluate) (2.31.0)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from evaluate) (4.66.1)\n","Requirement already satisfied: xxhash in /usr/local/lib/python3.10/dist-packages (from evaluate) (3.4.1)\n","Requirement already satisfied: multiprocess in /usr/local/lib/python3.10/dist-packages (from evaluate) (0.70.15)\n","Requirement already satisfied: fsspec[http]>=2021.05.0 in /usr/local/lib/python3.10/dist-packages (from evaluate) (2023.6.0)\n","Requirement already satisfied: huggingface-hub>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from evaluate) (0.19.3)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from evaluate) (23.2)\n","Collecting responses<0.19 (from evaluate)\n","  Downloading responses-0.18.0-py3-none-any.whl (38 kB)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets>=2.0.0->evaluate) (9.0.0)\n","Requirement already satisfied: pyarrow-hotfix in /usr/local/lib/python3.10/dist-packages (from datasets>=2.0.0->evaluate) (0.5)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from datasets>=2.0.0->evaluate) (3.8.6)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets>=2.0.0->evaluate) (6.0.1)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.7.0->evaluate) (3.13.1)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.7.0->evaluate) (4.5.0)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->evaluate) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->evaluate) (3.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->evaluate) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->evaluate) (2023.7.22)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->evaluate) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->evaluate) (2023.3.post1)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets>=2.0.0->evaluate) (23.1.0)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets>=2.0.0->evaluate) (6.0.4)\n","Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets>=2.0.0->evaluate) (4.0.3)\n","Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets>=2.0.0->evaluate) (1.9.2)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets>=2.0.0->evaluate) (1.4.0)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets>=2.0.0->evaluate) (1.3.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->evaluate) (1.16.0)\n","Installing collected packages: responses, evaluate\n","Successfully installed evaluate-0.4.1 responses-0.18.0\n"]}],"source":["pip install evaluate"]},{"cell_type":"markdown","metadata":{"id":"qnJPMiC4Y0dc"},"source":["**import Pacakages**"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"ZC9WyOP4Yzvu","executionInfo":{"status":"ok","timestamp":1700066872541,"user_tz":-360,"elapsed":5790,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"}}},"outputs":[],"source":["import pandas as pd\n","import tensorflow as tf\n","\n","from sklearn.model_selection import train_test_split\n"]},{"cell_type":"markdown","metadata":{"id":"iLsoq6Bebdk6"},"source":["# **Data Read**"]},{"cell_type":"code","execution_count":9,"metadata":{"id":"9RTnhboWbgWb","executionInfo":{"status":"ok","timestamp":1700066884392,"user_tz":-360,"elapsed":6363,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"}}},"outputs":[],"source":["# df = pd.read_csv('/content/drive/MyDrive/Defence/3.2 Cleaned_data.csv')\n","# df = pd.read_csv('/content/drive/MyDrive/colab/3.2 Cleaned_data.csv')\n","df = pd.read_csv('/content/drive/MyDrive/Thesis/Defence/3.2 Cleaned_data.csv')"]},{"cell_type":"code","execution_count":24,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":610,"status":"ok","timestamp":1700067066668,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"BIg5HsCl0Aal","outputId":"7dfe3ecf-ed71-4d44-f43f-edec7cf8a365"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(50000, 2)"]},"metadata":{},"execution_count":24}],"source":["df=df.iloc[:50000]\n","df.shape"]},{"cell_type":"code","execution_count":11,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":22,"status":"ok","timestamp":1700066884394,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"TKiQ-9jpDhhk","outputId":"55804dc0-e093-4e7f-fd66-5ac0a26d2be0"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["suicide        57698\n","non-suicide    42302\n","Name: class, dtype: int64"]},"metadata":{},"execution_count":11}],"source":["df['class'].value_counts()"]},{"cell_type":"code","execution_count":12,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20,"status":"ok","timestamp":1700066884394,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"4o22VBYUDoY0","outputId":"d9e088b8-a2e8-4e32-854a-3184e22b0e3a"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Index(['text', 'class'], dtype='object')"]},"metadata":{},"execution_count":12}],"source":["df.columns"]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":19,"status":"ok","timestamp":1700066884394,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"X5f_G8ekDq-u","outputId":"33b116a4-5004-4a2e-bdfe-f45b2a0391a9"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                    text        class\n","0      ex wife threatening suiciderecently i left my ...      suicide\n","1      am i weird i do not get affected by compliment...  non-suicide\n","2      i am so losthello, my name is adam (16) and i ...      suicide\n","3      honetly idki do not know what i am even doing ...      suicide\n","4      [trigger warning] excuse for self inflicted bu...      suicide\n","...                                                  ...          ...\n","99995  my left nut feels like spaghetti i suspect hav...  non-suicide\n","99996  sweet relief i just took a car ride home and i...  non-suicide\n","99997  i am thinking of commiting suicidefirst of all...      suicide\n","99998  i feel kind of self-conscious about my height....  non-suicide\n","99999  is there something wrong with me? i have this ...  non-suicide\n","\n","[100000 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-63b17ebd-beea-4b29-872f-3c92dd218d7a\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","      <th>class</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ex wife threatening suiciderecently i left my ...</td>\n","      <td>suicide</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>am i weird i do not get affected by compliment...</td>\n","      <td>non-suicide</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>i am so losthello, my name is adam (16) and i ...</td>\n","      <td>suicide</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>honetly idki do not know what i am even doing ...</td>\n","      <td>suicide</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>[trigger warning] excuse for self inflicted bu...</td>\n","      <td>suicide</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>99995</th>\n","      <td>my left nut feels like spaghetti i suspect hav...</td>\n","      <td>non-suicide</td>\n","    </tr>\n","    <tr>\n","      <th>99996</th>\n","      <td>sweet relief i just took a car ride home and i...</td>\n","      <td>non-suicide</td>\n","    </tr>\n","    <tr>\n","      <th>99997</th>\n","      <td>i am thinking of commiting suicidefirst of all...</td>\n","      <td>suicide</td>\n","    </tr>\n","    <tr>\n","      <th>99998</th>\n","      <td>i feel kind of self-conscious about my height....</td>\n","      <td>non-suicide</td>\n","    </tr>\n","    <tr>\n","      <th>99999</th>\n","      <td>is there something wrong with me? i have this ...</td>\n","      <td>non-suicide</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>100000 rows × 2 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-63b17ebd-beea-4b29-872f-3c92dd218d7a')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-63b17ebd-beea-4b29-872f-3c92dd218d7a button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-63b17ebd-beea-4b29-872f-3c92dd218d7a');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-ed17295a-4e15-49b4-9afe-e57eff9dfa7c\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-ed17295a-4e15-49b4-9afe-e57eff9dfa7c')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-ed17295a-4e15-49b4-9afe-e57eff9dfa7c button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":13}],"source":["dfc=df.copy()\n","dfc"]},{"cell_type":"markdown","metadata":{"id":"xABU_jOWcZO0"},"source":["**Chage the Label**"]},{"cell_type":"code","execution_count":25,"metadata":{"id":"uW-gPeAScYmU","executionInfo":{"status":"ok","timestamp":1700067073695,"user_tz":-360,"elapsed":474,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"}}},"outputs":[],"source":["# =============================================================================\n","# Change the Label\n","# =============================================================================\n","# array(['suicide', 'non-suicide'], dtype=object)\n","replacement_dict = {'suicide':0 ,'non-suicide':1}\n","df['class']=df['class'].replace(replacement_dict)\n"]},{"cell_type":"markdown","metadata":{"id":"YgOvrsAdcR-U"},"source":["# **Data Split**"]},{"cell_type":"code","execution_count":26,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14,"status":"ok","timestamp":1700067074226,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"sVMgnkvYcVyk","outputId":"ff7eb65a-7e91-4a9d-834b-2facc1b35ee1"},"outputs":[{"output_type":"stream","name":"stdout","text":["(35003,)\n","(4924,)\n","(10073,)\n"]}],"source":["# =============================================================================\n","# Data Split\n","# =============================================================================\n","Feature_data=df['text']\n","Label=df['class']\n","\n","# Split the data into training and the rest (validation + test)\n","X_train, X_temp, y_train, y_temp = train_test_split(Feature_data, Label, test_size=0.2999395, random_state=42, stratify=Label)\n","\n","# Split the remaining data (30%) into validation (10%) and test (20%)\n","X_test,X_val, y_test, y_val = train_test_split(X_temp, y_temp, test_size=0.328331, random_state=42)\n","\n","# 186841\n","print(X_train.shape) # 130800\n","print(X_val.shape) # 18400\n","print(X_test.shape) # 37641\n","\n"]},{"cell_type":"markdown","metadata":{"id":"RtNlVqplewFf"},"source":["# **LongFormer**"]},{"cell_type":"markdown","metadata":{"id":"kkgWY8OMfIzY"},"source":["**Preprocessing with Tokenization**"]},{"cell_type":"code","execution_count":27,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":872,"status":"ok","timestamp":1700067078421,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"5YDC9K1zs--W","outputId":"c97d34a4-ddd0-4e6f-bd94-24dc4df244b0"},"outputs":[{"output_type":"stream","name":"stdout","text":["Maximum length  embedding: 4098\n"]}],"source":["import torch\n","from transformers import AutoTokenizer, AutoModelForSequenceClassification, AutoConfig\n","from transformers import DataCollatorWithPadding\n","\n","model_name=\"allenai/longformer-base-4096\"\n","tokenizer=AutoTokenizer.from_pretrained(model_name)\n","\n","config = AutoConfig.from_pretrained(model_name)\n","\n","max_sequence_length = config.max_position_embeddings\n","print(\"Maximum length  embedding:\",max_sequence_length)"]},{"cell_type":"markdown","metadata":{"id":"4vQn3VZYXa0P"},"source":["**Create a Dataset object**"]},{"cell_type":"code","execution_count":28,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14,"status":"ok","timestamp":1700067078422,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"kQ0z1iw_Usiz","outputId":"e27ae140-fa98-411b-efdc-655ca327d147"},"outputs":[{"output_type":"stream","name":"stdout","text":["35003\n","Dataset({\n","    features: ['text', 'class', '__index_level_0__'],\n","    num_rows: 35003\n","})\n"]}],"source":["import datasets\n","from datasets import Dataset\n","\n","\n","# Create a Dataset object\n","train_dataset = Dataset.from_pandas(pd.DataFrame({'text': X_train, 'class': y_train}))\n","validation_dataset = Dataset.from_pandas(pd.DataFrame({'text': X_val, 'class': y_val}))\n","test_dataset = Dataset.from_pandas(pd.DataFrame({'text': X_test, 'class': y_test}))\n","\n","print(len(train_dataset))\n","print(train_dataset)"]},{"cell_type":"code","execution_count":32,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":113,"referenced_widgets":["9fe4f176902e4ddaaa5cb0ad8ff29eda","21f5d9b32c464c528f11e6d6e66506f3","9833b08cee7148b5902682aefe192a7e","b45b66772772469fb94a92a12e3b9193","90d6424d6cf64726b6705089da94fa78","d88f8b3c605642b9b845d287dab2b9f4","66309f2e8b6e49289e90df6115b685a3","7bbbdafdd4774310af46cedd697d2452","4248dfb20b194f218ec62e6ba32312ac","04aeb860150847b2aaf7b6de1404da52","0d30a54d575c4757b3f21ea319cf9aec","41709660afa94d858f0f3c4186b16680","f128aef5ea9e4bbca7bcccdd50a04ce9","72571ad7bde147dba2e8d0ce9853ba83","ac3840ff407a4c3f945e6534d107c2dd","872a9f89d50f452d895f545c60a710d8","5c090c34f37c4f5b8cd60316b838b5bd","f1e0f4b5246f44a88586d3bdc3fd40f7","1d57b07f915b4a6f8e628d80763b0740","61a102021fdc4f4793fe3a567f237447","2597b26c093c4de39c5782b82d94063b","4a7f8d67932d4cde978538eee267c7f2","f97b3f1b713b438b8786358a917e9e98","e73b87ee821e4bd487d1689d9fc5c007","fb89a23f9b89422493404f3ac34cd56b","6881a708c0d7492ab566d6ebceb5a44c","1891c7162ad54c14b51475542f315e15","b722f41d5fcf4e4391756f278f9d4a4b","6e54cf74ff74439e8695d582b1564918","cdb4ef5d4e51494487cc9c244ecdf879","21ae11f1defb4a65a81939aafb745828","2df215ee885642758d5f4eba3178f1b5","e4387ad6e86448dabac10ade78faf927"]},"executionInfo":{"elapsed":141467,"status":"ok","timestamp":1700067344100,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"yQ8UjUIeOVJJ","outputId":"4a926bad-b409-4a12-91a8-11131f4c5df8"},"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/35003 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"9fe4f176902e4ddaaa5cb0ad8ff29eda"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/4924 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"41709660afa94d858f0f3c4186b16680"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/10073 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f97b3f1b713b438b8786358a917e9e98"}},"metadata":{}}],"source":["def tokenize_function(examples):\n","    # print(\"Train dataset lengths:\", [len(tokenizer(examples[\"text\"])) for examples in train_dataset])\n","    return tokenizer(examples[\"text\"], padding=\"max_length\", max_length=4000, truncation=True)\n","\n","#tokenzation\n","train_dataset = train_dataset.map(tokenize_function, batched=True)\n","validation_dataset = validation_dataset.map(tokenize_function, batched=True)\n","test_dataset = test_dataset.map(tokenize_function, batched=True)\n","\n","# equal padding\n","data_collator = DataCollatorWithPadding(tokenizer=tokenizer)"]},{"cell_type":"markdown","metadata":{"id":"p7bgEVUiV1HA"},"source":["**PostProcessing**"]},{"cell_type":"code","execution_count":33,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":43,"status":"ok","timestamp":1700067344101,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"YHl624neV2z4","outputId":"174cc9b7-25ba-4cfe-e0a2-5d4a09493320"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["['labels', 'input_ids', 'attention_mask']"]},"metadata":{},"execution_count":33}],"source":["# Remove columns that the model does not expect\n","train_dataset = train_dataset.remove_columns([\"text\",'__index_level_0__'])\n","validation_dataset = validation_dataset.remove_columns([\"text\",'__index_level_0__'])\n","test_dataset = test_dataset.remove_columns([\"text\",'__index_level_0__'])\n","\n","# Rename the \"class\" column to \"labels\"\n","train_dataset = train_dataset.rename_column(\"class\", \"labels\")\n","validation_dataset = validation_dataset.rename_column(\"class\", \"labels\")\n","test_dataset = test_dataset.rename_column(\"class\", \"labels\")\n","\n","# Set the format to return PyTorch tensors\n","train_dataset.set_format(type='torch', columns=[\"attention_mask\", \"input_ids\", \"labels\"])\n","validation_dataset.set_format(type='torch', columns=[\"attention_mask\", \"input_ids\", \"labels\"])\n","test_dataset.set_format(type='torch', columns=[\"attention_mask\", \"input_ids\", \"labels\"])\n","\n","# train_dataset.set_format(type='torch')\n","train_dataset.column_names\n"]},{"cell_type":"markdown","metadata":{"id":"raCF48Ssc1Lc"},"source":["**Define DataLoaders**"]},{"cell_type":"markdown","metadata":{"id":"0S2ywVtv6BXF"},"source":["DataLoader is a utility that helps in efficiently loading and iterating over your dataset during training or evaluation by handling  tasks like batching, shuffling, and collating data."]},{"cell_type":"code","execution_count":34,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1700067344101,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"5D4ItTNcc4Yp","outputId":"555897fa-3514-4230-fc2a-3e3ee3149b9d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["4376"]},"metadata":{},"execution_count":34}],"source":["from torch.utils.data import DataLoader\n","\n","seed = 42\n","torch.manual_seed(seed)\n","\n","# Define data loaders\n","train_dataloader = DataLoader(train_dataset, batch_size=8,collate_fn =data_collator, shuffle=True)\n","validation_dataloader = DataLoader(validation_dataset, batch_size=8, shuffle=False)\n","test_dataloader = DataLoader(test_dataset, batch_size=8, shuffle=False)\n","len(train_dataloader)"]},{"cell_type":"markdown","metadata":{"id":"_xUKn7bqdBu2"},"source":["Check"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nbI-PujXdDXb","executionInfo":{"status":"aborted","timestamp":1700067147363,"user_tz":-360,"elapsed":70604,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"}}},"outputs":[],"source":["# for batch in train_dataloader:\n","#     break\n","# {k: v.shape for k, v in batch.items()}"]},{"cell_type":"markdown","metadata":{"id":"p_ZYZghmlAco"},"source":["# **Train Model**"]},{"cell_type":"code","execution_count":35,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2911,"status":"ok","timestamp":1700067347008,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"iHsjcoPdlEHm","outputId":"e525f5d2-6452-4fbe-fcec-f6643f9f6785"},"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of LongformerForSequenceClassification were not initialized from the model checkpoint at allenai/longformer-base-4096 and are newly initialized: ['classifier.out_proj.weight', 'classifier.out_proj.bias', 'classifier.dense.weight', 'classifier.dense.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]}],"source":["from transformers import AutoModelForSequenceClassification, AdamW\n","from transformers import Trainer, TrainingArguments\n","from accelerate import Accelerator\n","from tqdm.auto import tqdm\n","import evaluate\n","import numpy as np\n","\n","accelerator = Accelerator()\n","\n","id2label = {0: \"suicide\", 1: \"non-sucide\"}\n","label2id = {\"suicide\": 0, \"non-sucide\": 1}\n","\n","model = AutoModelForSequenceClassification.from_pretrained(model_name, num_labels=2, id2label=id2label, label2id=label2id)\n","model = model.to(accelerator.device)\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"ELumamcDlbGV"},"source":["Check if all is ready"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CtQ5PviIlep9","executionInfo":{"status":"aborted","timestamp":1700067049446,"user_tz":-360,"elapsed":10,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"}}},"outputs":[],"source":["# outputs = model(**batch)\n","# print(outputs.loss, outputs.logits.shape)\n","\n","# crash if the batch size =100"]},{"cell_type":"markdown","metadata":{"id":"qWsrSx17L7PN"},"source":["**Compute Metrices**"]},{"cell_type":"code","execution_count":36,"metadata":{"executionInfo":{"elapsed":685,"status":"ok","timestamp":1700067347680,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"},"user_tz":-360},"id":"iT02ya8nL6wp"},"outputs":[],"source":["accuracy = evaluate.load(\"accuracy\")\n","\n","def compute_metrics(eval_pred):\n","    predictions, labels = eval_pred\n","\n","    # For Gpu\n","    predictions = torch.argmax(torch.from_numpy(predictions), dim=1).cpu().numpy()\n","    return accuracy.compute(predictions=predictions, references=labels)\n","\n","    # predictions = np.argmax(predictions, axis=1)\n","    # return accuracy.compute(predictions=predictions, references=labels)"]},{"cell_type":"markdown","metadata":{"id":"bo5BKEIuLLyC"},"source":["**Training arguments**"]},{"cell_type":"code","execution_count":38,"metadata":{"id":"P9lIGvtA81pl","executionInfo":{"status":"ok","timestamp":1700067959481,"user_tz":-360,"elapsed":592,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"}}},"outputs":[],"source":["# Define training arguments\n","training_args = TrainingArguments(\n","    output_dir=\"./albert_classification\",\n","    num_train_epochs=3,\n","    learning_rate=3e-5,\n","    per_device_train_batch_size=8,\n","    per_device_eval_batch_size=8,\n","    warmup_steps=0,\n","    weight_decay=0.01,\n","    logging_dir=\"./logs\",\n","    logging_strategy='steps',\n","    evaluation_strategy=\"steps\", # \"steps,\" meaning evaluation will occur every epoch.\n","    eval_steps=300,\n","    save_strategy=\"steps\",\n","    save_steps=300,  # after every epoch the model will be saved\n","    load_best_model_at_end=True,\n","    remove_unused_columns=False,\n","    optim=\"adamw_torch\",\n","    gradient_accumulation_steps=10,\n","    # fp16=True,\n",")\n","# optimizerName:\n","# ['adamw_hf', 'adamw_torch', 'adamw_torch_fused', 'adamw_torch_xla', 'adamw_torch_npu_fused',\n","# 'adamw_apex_fused', 'adafactor', 'adamw_anyprecision', 'sgd', 'adagrad', 'adamw_bnb_8bit', 'adamw_8bit',\n","# 'lion_8bit', 'lion_32bit', 'paged_adamw_32bit', 'paged_adamw_8bit', 'paged_lion_32bit', 'paged_lion_8bit', 'rmsprop']"]},{"cell_type":"markdown","metadata":{"id":"Hu130zAnHzUe"},"source":["**Fintune**"]},{"cell_type":"markdown","metadata":{"id":"xYtexMd7LWcf"},"source":["Pass Training Aruguments"]},{"cell_type":"code","execution_count":39,"metadata":{"id":"mHGXG59ne9Ag","executionInfo":{"status":"ok","timestamp":1700067964926,"user_tz":-360,"elapsed":3,"user":{"displayName":"Abdullah-Al Mahmud","userId":"04147353860550875582"}}},"outputs":[],"source":["# Define Trainer\n","trainer = Trainer(\n","    model=model,\n","    args=training_args,\n","    train_dataset=train_dataset,\n","    eval_dataset=validation_dataset,\n","    data_collator=data_collator,\n","    compute_metrics=compute_metrics,\n","\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wF7wu3XtaVxk","outputId":"ae6875c0-30fe-4123-ff85-03e2a15d7206"},"outputs":[{"output_type":"stream","name":"stderr","text":["You're using a LongformerTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.\n"]}],"source":["trainer.train()"]},{"cell_type":"markdown","metadata":{"id":"2oE0W53PN1mo"},"source":["# **Load the PreTuned Model**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fiou16Z4N1Lp"},"outputs":[],"source":["# import torch\n","# from transformers import AutoModelForSequenceClassification, AutoConfig, TrainerState, TrainingArguments\n","# config = AutoConfig.from_pretrained('/content/albert_classification/checkpoint-19/config.json')\n","# model = AutoModelForSequenceClassification.from_pretrained('/content/albert_classification/checkpoint-19/model.safetensors', config=config)\n","\n","# optimizer = torch.load('/content/albert_classification/checkpoint-19/optimizer.pt')\n","\n","# random_state = torch.load('/content/albert_classification/checkpoint-19/rng_state.pth')\n","\n","# scheduler = torch.load('/content/albert_classification/checkpoint-19/scheduler.pt')\n","\n","# trainer_state = TrainerState.load_from_json('/content/albert_classification/checkpoint-19/trainer_state.json')\n"]},{"cell_type":"markdown","metadata":{"id":"GIotVzL5P-fh"},"source":["**Train Again**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ilMmggU_PLbR"},"outputs":[],"source":["\n","# traindf=traindfc.iloc[len(traindfc)//2:]\n","\n","# # Create a Dataset object\n","# train_dataset = Dataset.from_pandas(traindf)\n","\n","# def tokenize_function(examples):\n","#     return tokenizer(examples[\"text\"], padding=\"max_length\", max_length=512, truncation=True)\n","\n","# #tokenzation\n","# train_dataset = train_dataset.map(tokenize_function, batched=True)\n","\n","# train_dataset = train_dataset.remove_columns([\"text\",'__index_level_0__'])\n","# train_dataset = train_dataset.rename_column(\"class\", \"labels\")\n","# train_dataset.set_format(type='torch', columns=[\"attention_mask\", \"input_ids\", \"labels\"])\n","\n","# seed = 42\n","# torch.manual_seed(seed)\n","\n","# # Define data loaders\n","# train_dataloader = DataLoader(train_dataset, batch_size=18,collate_fn =data_collator, shuffle=True)\n"]},{"cell_type":"code","source":["# training_args = TrainingArguments(\n","#     output_dir=\"./albert_classification\",\n","#     num_train_epochs=3,\n","#     learning_rate=3e-5,\n","#     per_device_train_batch_size=18,\n","#     per_device_eval_batch_size=18,\n","#     warmup_steps=0,\n","#     weight_decay=0.01,\n","#     logging_dir=\"./logs\",\n","#     logging_strategy='epoch',\n","#     evaluation_strategy=\"epoch\", # \"steps,\" meaning evaluation will occur every epoch.\n","#     # eval_steps=500,\n","#     save_strategy=\"epoch\",\n","#     # save_steps=500,  # after every epoch the model will be saved\n","#     load_best_model_at_end=True,\n","#     remove_unused_columns=False,\n","#     optim=\"adamw_torch\",\n","#     gradient_accumulation_steps=10,\n","#     fp16=True,\n","# )\n","# trainer = Trainer(\n","#     model=model,\n","#     args=training_args,\n","#     train_dataset=train_dataset,\n","#     eval_dataset=validation_dataset,\n","#     data_collator=data_collator,\n","#     compute_metrics=compute_metrics,\n","\n","# )"],"metadata":{"id":"K4ZbkunUvNs1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# trainer.train()"],"metadata":{"id":"I6iisyJ_vSk-"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"JswXdZWC6bcx"},"source":["# **Evaluation**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ReiNu0zCeSOp"},"outputs":[],"source":["results = trainer.evaluate(test_dataset)\n","print(results)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"M_vuHriKIZSZ"},"outputs":[],"source":["test_accuracy = results[\"eval_accuracy\"]\n","# Make predictions on the test set\n","predictions = trainer.predict(test_dataset)\n","predicted_labels = torch.argmax(torch.tensor(predictions.predictions), dim=1).numpy()\n","\n","# Extract true labels\n","true_labels = test_dataset[\"labels\"].numpy()\n","\n","print(f\"Test Accuracy: {test_accuracy * 100:.2f}%\")\n","print(\"Done!\")"]},{"cell_type":"markdown","metadata":{"id":"IkzrQC1j0IlK"},"source":["# **Confusion Matrix**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xcEVV2v0ORv_"},"outputs":[],"source":["from sklearn.metrics import confusion_matrix\n","import seaborn as sns\n","import matplotlib.pyplot as plt\n","# Calculate the confusion matrix\n","confusion_matrix = confusion_matrix(true_labels, predicted_labels)\n","print(confusion_matrix)"]},{"cell_type":"markdown","metadata":{"id":"eZ7LnVsg0eSU"},"source":["**Figure**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Eu8xOaoK0Hds"},"outputs":[],"source":["# Draw the confusion matrix\n","plt.figure(figsize=(5, 5))\n","sns.heatmap(confusion_matrix, annot=True, fmt='d', cmap='Blues', cbar=False,\n","            xticklabels=['Class 0', 'Class 1'], yticklabels=['Class 0', 'Class 1'])\n","plt.xlabel('Predicted')\n","plt.ylabel('Actual')\n","plt.title('Confusion Matrix')\n","plt.show()\n","\n","print(\"Done!\")"]},{"cell_type":"markdown","metadata":{"id":"0WI_p4I80PnL"},"source":["**Report**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"903WidqP0RhO"},"outputs":[],"source":["from sklearn.metrics import classification_report\n","\n","\n","# Display classification report\n","class_report = classification_report(true_labels, predicted_labels, target_names=[\"non-suicide\", \"suicide\"])\n","\n","print(\"Classification Report:\\n\", class_report)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"c69QFG-RPtKg"},"outputs":[],"source":["from sklearn.metrics import accuracy_score\n","accuracy = accuracy_score(true_labels, predicted_labels)\n","print(f\"Accuracy: {accuracy * 100:.2f}%\")"]}],"metadata":{"colab":{"collapsed_sections":["qAI1JYDOYw0p","YgOvrsAdcR-U"],"provenance":[{"file_id":"1w3BhvJkX8kDIsd6miMSGyKwi4HnXpUBi","timestamp":1700066522144},{"file_id":"1supcU_XinMq1VDZNooA0m_J_DcIpX6pB","timestamp":1699868443650},{"file_id":"1MFW0P_hcAUB4OcTzZQfZgUoH2EUV6ypX","timestamp":1699852986824},{"file_id":"1Dayg2kQ0ncFmbx_8AV3wWqBMdsvUU9fx","timestamp":1699765957191}],"gpuType":"T4"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"9fe4f176902e4ddaaa5cb0ad8ff29eda":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_21f5d9b32c464c528f11e6d6e66506f3","IPY_MODEL_9833b08cee7148b5902682aefe192a7e","IPY_MODEL_b45b66772772469fb94a92a12e3b9193"],"layout":"IPY_MODEL_90d6424d6cf64726b6705089da94fa78"}},"21f5d9b32c464c528f11e6d6e66506f3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d88f8b3c605642b9b845d287dab2b9f4","placeholder":"​","style":"IPY_MODEL_66309f2e8b6e49289e90df6115b685a3","value":"Map: 100%"}},"9833b08cee7148b5902682aefe192a7e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_7bbbdafdd4774310af46cedd697d2452","max":35003,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4248dfb20b194f218ec62e6ba32312ac","value":35003}},"b45b66772772469fb94a92a12e3b9193":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_04aeb860150847b2aaf7b6de1404da52","placeholder":"​","style":"IPY_MODEL_0d30a54d575c4757b3f21ea319cf9aec","value":" 35003/35003 [01:46&lt;00:00, 413.16 examples/s]"}},"90d6424d6cf64726b6705089da94fa78":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d88f8b3c605642b9b845d287dab2b9f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"66309f2e8b6e49289e90df6115b685a3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7bbbdafdd4774310af46cedd697d2452":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4248dfb20b194f218ec62e6ba32312ac":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"04aeb860150847b2aaf7b6de1404da52":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0d30a54d575c4757b3f21ea319cf9aec":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"41709660afa94d858f0f3c4186b16680":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f128aef5ea9e4bbca7bcccdd50a04ce9","IPY_MODEL_72571ad7bde147dba2e8d0ce9853ba83","IPY_MODEL_ac3840ff407a4c3f945e6534d107c2dd"],"layout":"IPY_MODEL_872a9f89d50f452d895f545c60a710d8"}},"f128aef5ea9e4bbca7bcccdd50a04ce9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5c090c34f37c4f5b8cd60316b838b5bd","placeholder":"​","style":"IPY_MODEL_f1e0f4b5246f44a88586d3bdc3fd40f7","value":"Map: 100%"}},"72571ad7bde147dba2e8d0ce9853ba83":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1d57b07f915b4a6f8e628d80763b0740","max":4924,"min":0,"orientation":"horizontal","style":"IPY_MODEL_61a102021fdc4f4793fe3a567f237447","value":4924}},"ac3840ff407a4c3f945e6534d107c2dd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2597b26c093c4de39c5782b82d94063b","placeholder":"​","style":"IPY_MODEL_4a7f8d67932d4cde978538eee267c7f2","value":" 4924/4924 [00:12&lt;00:00, 439.21 examples/s]"}},"872a9f89d50f452d895f545c60a710d8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5c090c34f37c4f5b8cd60316b838b5bd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f1e0f4b5246f44a88586d3bdc3fd40f7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1d57b07f915b4a6f8e628d80763b0740":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"61a102021fdc4f4793fe3a567f237447":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2597b26c093c4de39c5782b82d94063b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4a7f8d67932d4cde978538eee267c7f2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f97b3f1b713b438b8786358a917e9e98":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e73b87ee821e4bd487d1689d9fc5c007","IPY_MODEL_fb89a23f9b89422493404f3ac34cd56b","IPY_MODEL_6881a708c0d7492ab566d6ebceb5a44c"],"layout":"IPY_MODEL_1891c7162ad54c14b51475542f315e15"}},"e73b87ee821e4bd487d1689d9fc5c007":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b722f41d5fcf4e4391756f278f9d4a4b","placeholder":"​","style":"IPY_MODEL_6e54cf74ff74439e8695d582b1564918","value":"Map: 100%"}},"fb89a23f9b89422493404f3ac34cd56b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_cdb4ef5d4e51494487cc9c244ecdf879","max":10073,"min":0,"orientation":"horizontal","style":"IPY_MODEL_21ae11f1defb4a65a81939aafb745828","value":10073}},"6881a708c0d7492ab566d6ebceb5a44c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2df215ee885642758d5f4eba3178f1b5","placeholder":"​","style":"IPY_MODEL_e4387ad6e86448dabac10ade78faf927","value":" 10073/10073 [00:22&lt;00:00, 483.61 examples/s]"}},"1891c7162ad54c14b51475542f315e15":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b722f41d5fcf4e4391756f278f9d4a4b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6e54cf74ff74439e8695d582b1564918":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cdb4ef5d4e51494487cc9c244ecdf879":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"21ae11f1defb4a65a81939aafb745828":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2df215ee885642758d5f4eba3178f1b5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e4387ad6e86448dabac10ade78faf927":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}